/*! SOP - v0.1.0 - 2014-11-24 */function graficaCtrl(a,b,c,d,e,f,g){a.chartType="bar",a.juzgadosQueryIsShown=!1,a.chartIsShown=!1,a.isNotAutoridadQuery=!1,a.isDisabled=!0,a.query="",a.callbacks=[],a.series=[],a.dataArray=[],a.monthsRange=[],a.tiposDeJuzgados=[],a.autoridadArray=[],a.disableButtons=function(){a.disableStyle=a.isDisabled?{"background-color":"grey","border-color":"black"}:{}},a.disableButtons(),a.configChart=function(){a.config={title:a.requestedtQuery,tooltips:!0,labels:!1,mouseover:function(){},mouseout:function(){},click:function(){},legend:{display:!0,position:"right"}}},a.show=function(){},a.cleanArray=function(a){for(;a.length;)a.pop()},a.reset=function(){a.isDisabled=!1,a.disableButtons(),a.chartIsShown=!1,a.isNotAutoridadQuery=!1,a.juzgadosQueryIsShown=!1,a.cleanArray(a.series),a.cleanArray(a.series),a.cleanArray(a.dataArray),a.dataArray=[],a.cleanArray(a.monthsRange),a.cleanArray(a.tiposDeJuzgados),a.cleanArray(a.autoridadArray),a.config={},a.data={};for(var b=0;b<a.callbacks.length;b++)"autoridad"!=a.query?e.destroyFirebaseObject(a.callbacks[b]):e.destroyFirebaseReference(a.callbacks[b]);"autoridad"==a.query&&(e.destroyFirebaseObject(a.firstCall),e.destroyFirebaseObject(a.secondCall),e.destroyFirebaseObject(a.thirdCall))},a.totalesQuery=function(b,d){a.callbacks[d]=c(new Firebase(b)).$asObject();var e=a.callbacks[d].$inst()._ref.path.n[2];a.callbacks[d].$loaded().then(function(b){a.dataArray.push({x:e.substring(0,3),y:[b.$value]})})},a.juicioQuery=function(b,d){a.callbacks[d]=c(new Firebase(b)).$asArray();var e=a.callbacks[d].$inst()._ref.path.n[2];a.series.push({spot:d,month:e,labels:[]}),a.callbacks[d].$loaded().then(function(b){for(var c=[],f=0;f<b.length;f++)if("Tipo de Juicio"!=b[f].$id){c.push(b[f].$value);for(var g=0;g<a.series.length;g++)a.series[g].spot==d&&a.series[d].labels.push({placeInChart:f+1,name:b[f].$id,val:b[f].$value})}a.dataArray.push({x:e.substring(0,3),y:c})})},a.tiposDeJuzgadoQuery=function(b,d,e){a.juzgadosQueryIsShown=!0,a.firstCall=c(b).$asArray(),a.tiposDeJuzgados.push({place:d,month:a.firstCall.$inst()._ref.path.n[2],values:[]}),a.firstCall.$watch(function(b){a.secondCall=c(new Firebase(e+"/"+b.key)).$asArray();a.secondCall.$inst()._ref.path.n[2];a.secondCall.$watch(function(f){if("contAutoridad"!=f.key){a.thirdCall=c(new Firebase(e+"/"+b.key+"/"+f.key)).$asObject();{a.thirdCall.$inst()._ref.path.n[2]}a.thirdCall.$loaded().then(function(b){c(a.callbacks[d]).$ref().path.n[2];for(a.w=0;a.w<a.tiposDeJuzgados.length;a.w++)if(a.tiposDeJuzgados[a.w].place==d){var e=[{name:b.$id,value:b.$value,place:d}];a.tiposDeJuzgados[d].values.push(e)}})}})})},a.autoridadQuery=function(b,d){a.callbacks[d]=new Firebase(b),a.tiposDeJuzgadoQuery(a.callbacks[d],d,b),a.callbacks[d].once("value",function(b){var e=c(a.callbacks[d]);a.autoridadArray.push({x:e.$ref().path.n[2].substring(0,3),y:[b.val().PGJE.contAutoridad,b.val().PJE.contAutoridad,b.val().PJF.contAutoridad]})})},a.resolveQuery=function(b,c){for(a.z=0;a.z<b.length;a.z++){var d=f.getYear(b[a.z]),e=f.getMonthName(b[a.z]),h=g.getContadoresRef()+d+"/"+e+"/"+a.query;c(h,a.z)}},a.expectQuery=function(b){switch(a.chartIsShown=!0,a.data={series:[],data:[]},a.cleanArray(a.autoridadArray),a.requestedtQuery){case"Autoridad":a.query="autoridad",a.resolveQuery(b,a.autoridadQuery),a.configChart(),a.data={series:["PGJE","PJE","PJF"],data:a.autoridadArray};break;case"Tipo de juicio":a.query="juicio",a.resolveQuery(b,a.juicioQuery),a.configChart(),a.isNotAutoridadQuery=!0,a.data={series:[],data:a.dataArray};break;case"Municipio":a.query="municipio",a.resolveQuery(b,a.juicioQuery),a.configChart(),a.isNotAutoridadQuery=!0,a.data={series:[],data:a.dataArray};break;case"Menores":a.query="totalMenores",a.resolveQuery(b,a.totalesQuery),a.configChart(),a.isNotAutoridadQuery=!1,a.data={series:["Total de menores"],data:a.dataArray};break;case"Oficios":a.query="totalOficios",a.resolveQuery(b,a.totalesQuery),a.configChart(),a.isNotAutoridadQuery=!1,a.data={series:["Total de oficios"],data:a.dataArray};break;default:d.open({template:"queryMessage"})}},a.getData=function(){""==a.beginDate||""==a.endDate?d.open({template:"alertMessage"}):(a.monthsRange=f.getMonthsRange(a.beginDate,a.endDate),a.expectQuery(a.monthsRange))}}angular.module("sodif").controller("graficaCtrl",graficaCtrl),graficaCtrl.$inject=["$scope","$state","$firebase","ngDialog","destroyerFactory","dateFactory","firebaseRefFactory"];