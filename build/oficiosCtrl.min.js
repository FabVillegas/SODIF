/*! SOP - v0.1.0 - 2014-11-24 */function oficiosCtrl(a,b,c,d,e,f,g){a.afterChangingMonth=function(){a.first=1,a.last=10,a.getOficios()},a.myData=[],a.years=[],a.months=[],a.oficiosArray=[],a.yearsRef="",a.monthsRef="",a.oficios=[],a.mySelections=[],a.first=1,a.last=10,a.getYears=function(){a.yearsRef=b(new Firebase(f.goToRef("capturas"))).$asArray(),a.yearsRef.$watch(function(b){a.years.push({key:b.key})}),a.first=1,a.last=10},a.getMonths=function(){a.months=[],a.monthsRef=b(new Firebase(f.getCapturasMonthsRef(a.selectedYear))).$asArray(),a.monthsRef.$watch(function(b){a.months.push({key:b.key})}),a.first=1,a.last=10},a.goDetalle=function(b,c){if(void 0!=c){var d=g.getYear(b),f=g.getMonth(b);a.yearsRef.$destroy(),a.monthsRef.$destroy(),a.oficiosRef.off(),e.path("/oficios/"+d+"/"+f+"/"+c)}};var h={init:function(b,c){h.scope=b,h.grid=c,a.$watch(function(){var a="";return angular.forEach(h.scope.columns,function(b){if(b.visible&&b.filterText){var c=(0==b.filterText.indexOf("*")?b.filterText.replace("*",""):"^"+b.filterText)+";";a+=b.displayName+": "+c}}),a},function(a){h.scope.$parent.filterText=a,h.grid.searchProvider.evalFilter()})},scope:void 0,grid:void 0};a.gridOptions={data:"myData",enablePinning:!0,columnDefs:[{field:"numero",displayName:"# Control",width:100,pinned:!0,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"folio",displayName:"# Folio",width:100,pinned:!0,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"fecha",displayName:"Fecha",width:175,pinned:!0,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"autoridad",displayName:"Autoridad Correspondiente",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"tipoJuzgado",displayName:"Tipo de Juzgado",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"tipoDeJuicio",displayName:"Tipo de Juicio",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"municipio",displayName:"Municipio",width:150,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"servicio",displayName:"Servicio",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"areaDeServicio",displayName:"Área de servicio",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"tipoDeServicio",displayName:"Tipo de servicio",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"},{field:"descripcion",displayName:"Descripción",width:250,headerCellTemplate:"views/filterHeaderTemplate.html"}],plugins:[h],headerRowHeight:60,selectedItems:a.mySelections,multiSelect:!1,plugins:[h],beforeSelectionChange:function(a){return a.changed=!0,!0},afterSelectionChange:function(b){b.changed&&(console.log("deal with row "+b.entity.numero),a.goDetalle(b.entity.fecha,b.entity.numero),b.changed=!1)}},a.changePagination=function(b){"next"==b&&(a.first+=10,a.last+=10,a.getOficios()),"back"==b&&(a.first-=10,a.first<1&&(a.first=1),a.last-=10,a.last<10&&(a.last=10),a.getOficios())},a.getOficios=function(){a.oficios=[],a.oficiosRef=new Firebase(f.getRefToSaveCaptura(a.selectedYear,a.selectedMonth)),a.oficiosRef.startAt(a.first).endAt(a.last).on("child_added",function(c){if(c.val()){var d=b(new Firebase(f.getOficio(c.key()))).$asObject();a.oficios.push(d),a.myData=a.oficios}})},a.getYears()}angular.module("sodif").controller("oficiosCtrl",oficiosCtrl),oficiosCtrl.$inject=["$scope","$firebase","$state","$stateParams","$location","firebaseRefFactory","dateFactory"];